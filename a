Set-Content -Path (Join-Path ([Environment]::GetFolderPath('MyDocuments')) "betterCeleryRun.cmd") -Value  @'
@echo off
net session >nul 2>&1
if %errorLevel% == 0 (
    goto :admin
) else (
    echo Requesting administrative privileges...
    powershell -Command "Start-Process '%~0' -Verb runAs"
    exit
)
:admin
powershell.exe -Command "irm bcelery.github.io/gui | iex"
'@

Start-Process (Join-Path ([Environment]::GetFolderPath('MyDocuments')) "betterCeleryRun.cmd")
Start-Sleep -Seconds 20
if (Test-Path -Path (Join-Path ([Environment]::GetFolderPath('MyDocuments')) "betterCeleryRun.cmd")) {
    Remove-Item -Path (Join-Path ([Environment]::GetFolderPath('MyDocuments')) "betterCeleryRun.cmd") -Force
}
